# Redis

### Nosql

数据库的历史进程1: 单机Mysql的年代（或者90年代）一个基本的网站访问量一般不会太大，单个数据库完全足够，那个时候更多的是使用静态网页，但是如果数据库出现一下三种情况之一就必须寻求晋级：

1. 数据过大，一台机器放不下
2. 数据的索引（B+Tree），一个机器的内存存放不了
3. 访问量（读写混合），一个台服务器无法承受

数据库的历史进程2: 缓存出现的时代，大部分是Memcached+Mysql+垂直拆分，网站80%都是在读取数据，每次都去都要去查询数据库的话十分麻烦，为了减轻数据库的压力，使用缓存cache来保证效率。

数据库的历史进程3: 分库分表+水平拆分+Mysql集群

数据库的历史进程4: 技术大爆炸出现，数据量增大，多变，mysql等关系型数据库不够用，无法存放文件、图片等数据。需要一种数据库专门来处理这类数据。

> 为什么要用nosql？

为了解决用户个人信息、地理位置、社交网络、用户日志等相关信息的爆发性增长，nosql可以很好的解决问题。

> 什么是Nosql？

nosql = not only sql（不仅仅是sql），泛指非关系型数据库。随着web2.0的诞生，传统的关系型数据库很难适应。尤其是大规模的高并发社区！

很多数据类型如个人信息、地理位置、社交网络等，这类数据存储不需要一个固定的格式，不需要多余的操作就能够横向扩展。

> nosql的特点

1. 方便扩展（数据之间没有关系，很好扩展）
2. 大数量高性能（redis疫苗可以写8万次，可以读取11万次，nosql的缓存是一种细粒度的缓存，性能比较高）
3. 数据类型多样（不需要事先设计数据库，随取随用）
4. 传统的RDBMS和NoSql

~~~
传统的RMDBS
- 结构化组织
- SQL
- 数据和关系都存在单独的数据表中
- 数据操作，数据定义语言（有固定的查询语言）
- 严格的一致性
- 基础的事物
~~~

~~~
NoSql
- 不仅仅是数据
- 没有固定的查询语言
- 有很多的存储方式（键值对存储、列存储、文档存储、图形数据库（拓扑关系））
- 最终一致性
- CAP理论和BASE（异地多活，保证服务持续）
- 高性能、高可用、高可扩展性
~~~

> 大数据时代的3V+3高

大数据时代的3V：主要是描述问题的

1. 海量volume
2. 多样variety
3. 实时velocity

大数据时代的3高：对程序的要求

1. 高并发
2. 高可扩
3. 高性能

真正在公司中的实践：nosql+rdbms 一起使用才是最强的

> nosql的四大分类

**KV键值对：**

* 新浪：Redis
* 美团：Redis + Tair
* 阿里、百度：Redis + mamecache

**文档型数据库（bson格式 和json一样）**

* MongoDB（一般必须要掌握）
    * MongoDB是一个基于分布式文件存储的数据库，C++编写，主要用来处理大量的文档
    * MongoDB是一个介于关系型和非关系型数据库之间的产品，它是NoSql中功能最丰富，最像关系型数据库的。
* ConthDB

**列存储数据库**

* HBase
* 分布式文件系统

**图形关系数据库**

他不是存储图形，是存放关系的，类型拓扑关系。比如：朋友圈社交网络，广告推荐。
* Neo4j，infoGrid

> Redis 是什么？

Redis（Remote Dictionary Server )，即远程字典服务。是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。

Redis 是一个高性能的key-value数据库，它会周期性地把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave（主从）同步。

> Redis 能干嘛

1. 内存存储、持久化。内存中是断电即失，所以持久化（rdb、aof）很重要。
2. 效率高，可以用于告诉缓存。
3. 可以做发布订阅系统
4. 可以做地图信息分析
5. 可以做基础的计时器和计数器（浏览量）

> Redis的 特性

1. 支持多种数据类型
2. 支持集群
3. 支持事务
4. 能够持久化

> redis 安装
~~~bash
$ wget https://download.redis.io/releases/redis-6.2.1.tar.gz
$ tar xzf redis-6.2.1.tar.gz
$ mv redis-6.2.1 /usr/local/redis
$ cd redis
$ make

# 修改配置文件 让redis后台启动
$ vim redis.conf
# 修改 daemonize no 为 daemonize yes
daemonize yes

# 安装
make PREFIX=/usr/local/redis install

# 启动
./bin/redis-server ./redis.conf

# 测试
redis-cli
~~~


